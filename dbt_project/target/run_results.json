{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-07-24T08:40:30.593933Z", "invocation_id": "63fc645b-6035-4cef-922d-0557aeac7485", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T08:40:20.340222Z", "completed_at": "2025-07-24T08:40:20.350039Z"}, {"name": "execute", "started_at": "2025-07-24T08:40:20.350621Z", "completed_at": "2025-07-24T08:40:20.975682Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6365945339202881, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bde628-0000-a305-0000-ab65000291a2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_project.stg_raw_line_items", "compiled": true, "compiled_code": "with source as (\n\n    select * from snowflake_sample_data.tpch_sf1.lineitem\n\n),\nrenamed as (\n    select\n        l_orderkey || '-' || l_linenumber as order_item_key,\n        l_orderkey as order_key,\n        l_partkey as part_key,\n        l_suppkey as supplier_key,\n        l_linenumber as line_number,\n        l_quantity as quantity,\n        l_extendedprice as extended_price,\n        l_discount as discount_percentage,\n        l_tax as tax_rate,\n        l_returnflag as return_flag,\n        l_linestatus as status_code,\n        l_shipdate as ship_date,\n        l_commitdate as commit_date,\n        l_receiptdate as receipt_date,\n        l_shipinstruct as ship_instructions,\n        l_shipmode as ship_mode,\n        l_comment as comment\n    from source\n\n)\n\nselect * from renamed", "relation_name": "DBT_DEMO_DB.dev.stg_raw_line_items", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T08:40:20.980776Z", "completed_at": "2025-07-24T08:40:20.986231Z"}, {"name": "execute", "started_at": "2025-07-24T08:40:20.986653Z", "completed_at": "2025-07-24T08:40:21.467013Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4873206615447998, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bde628-0000-a305-0000-ab65000291c2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_project.stg_raw_orders", "compiled": true, "compiled_code": "with source as (\n\n    select * from snowflake_sample_data.tpch_sf1.orders\n\n),\nrenamed as (\n\n    select\n        o_orderkey as order_key,\n        o_custkey as customer_key,\n        o_orderstatus as status_code,\n        o_totalprice as total_price,\n        o_orderdate as order_date,\n        o_orderpriority as priority_code,\n        o_clerk as clerk_name,\n        o_shippriority as ship_priority,\n        o_comment as comment\n    from source\n)\nselect * from renamed", "relation_name": "DBT_DEMO_DB.dev.stg_raw_orders", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T08:40:21.471453Z", "completed_at": "2025-07-24T08:40:21.476309Z"}, {"name": "execute", "started_at": "2025-07-24T08:40:21.476731Z", "completed_at": "2025-07-24T08:40:28.007350Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 6.536861419677734, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bde628-0000-a305-0000-ab65000291e2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_project.int_order_items", "compiled": true, "compiled_code": "with orders as (\n    \n    select * from DBT_DEMO_DB.dev.stg_raw_orders\n\n),\n\nline_item as (\n\n    select * from DBT_DEMO_DB.dev.stg_raw_line_items\n\n)\nselect \n\n    l.order_item_key,\n    o.order_key,\n    o.customer_key,\n    o.order_date,\n    o.status_code as order_status_code,\n    l.part_key,\n    l.supplier_key,\n    l.return_flag,\n    l.line_number,\n    l.status_code as order_item_status_code,\n    l.ship_date,\n    l.commit_date,\n    l.receipt_date,\n    l.ship_mode,\n    l.extended_price,\n    l.quantity,\n    \n    -- extended_price is actually the line item total,\n    -- so we back out the extended price per item\n    (l.extended_price/nullif(l.quantity, 0))::decimal(16,2) as base_price,\n    l.discount_percentage,\n    (base_price * (1 - l.discount_percentage))::decimal(16,2) as discounted_price,\n\n    l.extended_price as gross_item_sales_amount,\n    (l.extended_price * (1 - l.discount_percentage))::decimal(16,2) as discounted_item_sales_amount,\n    -- We model discounts as negative amounts\n    (-1 * l.extended_price * l.discount_percentage)::decimal(16,2) as item_discount_amount,\n    l.tax_rate,\n    ((gross_item_sales_amount + item_discount_amount) * l.tax_rate)::decimal(16,2) as item_tax_amount,\n    (\n        gross_item_sales_amount + \n        item_discount_amount + \n        item_tax_amount\n    )::decimal(16,2) as net_item_sales_amount\n\nfrom\n    orders o\ninner join line_item l\n        on o.order_key = l.order_key\norder by\n    o.order_date", "relation_name": "DBT_DEMO_DB.dev.int_order_items", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T08:40:28.011750Z", "completed_at": "2025-07-24T08:40:28.016489Z"}, {"name": "execute", "started_at": "2025-07-24T08:40:28.017027Z", "completed_at": "2025-07-24T08:40:30.587572Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.576848030090332, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bde628-0000-a305-0000-ab6500029202"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_project.fct_orders", "compiled": true, "compiled_code": "with orders as (\n    \n    select * from DBT_DEMO_DB.dev.stg_raw_orders \n\n),\norder_item as (\n    \n    select * from DBT_DEMO_DB.dev.int_order_items\n\n),\norder_item_summary as (\n\n    select \n        order_key,\n        sum(gross_item_sales_amount) as gross_item_sales_amount,\n        sum(item_discount_amount) as item_discount_amount,\n        sum(item_tax_amount) as item_tax_amount,\n        sum(net_item_sales_amount) as net_item_sales_amount\n    from order_item\n    group by\n        1\n),\nfinal as (\n\n    select \n\n        orders.order_key, \n        orders.order_date,\n        orders.customer_key,\n        orders.status_code,\n        orders.priority_code,\n        orders.clerk_name,\n        orders.ship_priority,\n                \n        1 as order_count,                \n        order_item_summary.gross_item_sales_amount,\n        order_item_summary.item_discount_amount,\n        order_item_summary.item_tax_amount,\n        order_item_summary.net_item_sales_amount\n    from\n        orders\n        inner join order_item_summary\n            on orders.order_key = order_item_summary.order_key\n)\nselect \n    *\nfrom\n    final\n\norder by\n    order_date", "relation_name": "DBT_DEMO_DB.dev.fct_orders", "batch_results": null}], "elapsed_time": 11.00033164024353, "args": {"require_resource_names_without_spaces": false, "use_colors_file": true, "warn_error_options": {"include": [], "exclude": []}, "use_colors": true, "strict_mode": false, "log_format_file": "debug", "favor_state": false, "log_format": "default", "require_nested_cumulative_type_params": false, "indirect_selection": "eager", "project_dir": "/tmp/dbt", "quiet": false, "state_modified_compare_vars": false, "select": [], "print": true, "target": "dev", "profiles_dir": "/tmp/dbt/", "partial_parse_file_diff": true, "require_explicit_package_overrides_for_builtin_materializations": true, "version_check": true, "log_file_max_bytes": 10485760, "macro_debugging": false, "introspect": true, "log_level_file": "debug", "empty": false, "write_json": true, "state_modified_compare_more_unrendered_values": false, "log_level": "info", "show_resource_report": false, "invocation_command": "dbt ", "exclude": [], "cache_selected_only": false, "source_freshness_run_project_hooks": false, "vars": {}, "target_path": "/tmp/dbt/target/", "partial_parse": true, "log_path": "/tmp/dbt/logs", "require_batched_execution_for_custom_microbatch_strategy": false, "require_yaml_configuration_for_mf_time_spines": false, "populate_cache": true, "printer_width": 80, "static_parser": true, "which": "run", "defer": false, "send_anonymous_usage_stats": false, "skip_nodes_if_on_run_start_fails": false}}